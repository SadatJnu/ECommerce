@{
    ViewBag.Title = "Product";
}
<style>
    .required {
        color:red !important;
    }
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
        -moz-appearance: textfield !important;
        -webkit-appearance: none;
        margin: 0;
    } 
    fieldset.scheduler-border {
        border: 1px solid #ccc;
        padding: 0px 5px 10px 5px;
        -webkit-box-shadow: 0px 0px 0px 0px #000;
        box-shadow: 0px 0px 0px 0px #000;
    }

    legend.scheduler-border {
        margin-bottom: 5px;
        font-size: 14px;
        font-weight: bold;
        text-align: left;
        width: auto;
        padding: 0 0px;
        border-bottom: none;
        margin-left: -15px;
    }

    /*pagination*/
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
        -moz-appearance: textfield !important;
        -webkit-appearance: none;
        margin: 0;
    }

    .pagination {
        margin: 0px;
    }

        .pagination span {
            padding: 1px 9px;
            height: 25px;
            background-color: #dddddd;
            border: 1px solid #868e96 !important;
            color: #000;
        }

    .focusNumber {
        background-color: #3C8DBC !important;
        color: #fff;
        cursor: pointer;
        font-weight: bold;
    }

    .activePage {
        cursor: pointer;
        font-weight: bold;
    }

    .pageNumbers:hover {
        box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
    }
    /*./pagination*/

    .table tbody > tr > td {
        vertical-align: middle !important;
    }

    .table tbody > tr > th {
        vertical-align: middle !important;
    }

    .info-box-text {
        text-transform: uppercase;
        text-align: center;
        padding-bottom: 10px;
        font-size: 18px;
        color: #000;
    }

    .info-box-content {
        padding: 9px 10px;
        margin-left: 90px;
    }

    .attendance:hover .info-box-content {
        background: #f39c12;
        color: #fff;
    }

    .attendance:hover .info-box-text {
        color: #fff;
    }

    .currenttime ul {
        padding: 0px;
        margin: 0px;
    }

        .currenttime ul li {
            display: inline;
        }

    input, select, textarea {
        height: 31px;
        width: 100% !important;
    }

    .checkboxSize {
        height: 20px;
        width: 100% !important;
    }

    th {
        white-space: nowrap;
        border: 1px solid #ccc !important;
    }

        th.trBorder, td {
            border: 1px solid #ccc !important;
        }

    #searchpagenumber {
        border: 1px solid #868e96 !important;
    }

    .box {
        margin-bottom: 0px;
    }

    @@media(min-width:768px) and (max-width:1280px) {
        .screensize {
            width: 100% !important;
        }
    }
    .modal-dialog {
        width: 60% !important;
        margin-left: 35% !important;
    }
    .modal-content {
        width: 60% !important;
    }
</style>

<section class="content-header">
    <ol class="breadcrumb">
        <li><a href="~/Home/Index"><i class="fa fa-home"></i> Home</a></li>
    </ol>
    <ol class="breadcrumb">
        <button class="btn btn-green" @*data-target="#addmodal"*@ id="modalShowing" data-toggle="modal"> <i class="fa fa-plus"></i> Add Product</button>
    </ol>
</section>

<!-- Begin: life time stats -->
<div class="portlet light bordered">
    <div class="portlet-title">
        <div class="caption">
            <i class="icon-settings font-green"></i>
            <a href="~/Home/Index"><i class="fa fa-home"></i> Home</a>
        </div>
        <div class="actions">
            <div class="btn-group btn-group-solid pull-right">
            </div>
        </div>
    </div>
</div>
<!-- End: life time stats -->
<!--Modal Area Start-->
<div id="addmodal" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <form name="addform" class="form-horizontal" id="addform" novalidate>
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                    <h4 class="modal-title"><span id="title"></span></h4>
                </div>
                <div class="modal-body">
                    <div class="form-body">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-md-4 control-label">
                                        Product Name :
                                        <span class="required">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <input type="hidden" class="form-control" name="Id" id="Id" />
                                        <input type="text" class="form-control" name="ProductName" id="ProductName" autocomplete="off" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-4 control-label">
                                        Buying Price :
                                        <span class="required">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <input type="number" class="form-control" name="BuyingPrice" id="BuyingPrice" autocomplete="off" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-4 control-label">
                                        Selling Price :
                                        <span class="required">*</span>
                                    </label>
                                    <div class="col-md-8">
                                        <input type="number" class="form-control" name="SellingPrice" id="SellingPrice" autocomplete="off" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="col-md-2 pull-right">
                                    @*<input type="submit" class="btn btn-warning pull-left" id="btnCancel" value="Cancel" />*@
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                                <div class="col-md-2 pull-right">
                                    <input type="submit" class="btn btn-primary pull-right" name="btnSave" id="btnSave" value="Save" />
                                </div>
                            </div>
                        </div>
                    </div>                   
                </div>
            </form>
        </div>
    </div>
</div>
<!--Modal Area End-->

<div style="top:5px;">
    <section class="content">
        <div class="row" style="padding-bottom: 10px;margin-right:0px;margin-left:0px;">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="box box-info">
                    <table class="table no-margin display table-striped table-condensed table-hover table-responsive display nowrap">
                        <thead>
                            <tr style="background: lightgray;">
                                <th style="width:5%">SL</th>
                                <th style="width:15%">Product Name</th>
                                <th style="width:15%">Buying Price</th>
                                <th style="width:15%">Selling Price</th>
                                <th colspan="2" style="width:2%">Modify</th>
                            </tr>
                        </thead>
                        <tbody id="lst"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
</div>



<link href="~/Scripts/toastr.min.css" rel="stylesheet" />
<script src="~/Scripts/App.js"></script>
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script src="~/Scripts/toastr.min.js"></script>

<script>

    $(document).ready(function () {

        GetProductList();

        $('#btnSave').click(function () {
            if ($('#ProductName').val().trim() == '')
            {
                toastr["error"]('Product Name Required');
                return false;
            }
            else if ($('#BuyingPrice').val() == '')
            {
                toastr["error"]('Buying Price Required');
                return false;
            }
            else if ($('#SellingPrice').val() == '')
            {
                toastr["error"]('Selling Price Required');
                return false;
            }
            else
            {
                //var data = $('#addform').serialize();
               var data =
               {
                    Id: $('#Id').val(),
                    ProductName: $('#ProductName').val().trim(),
                    BuyingPrice: $('#BuyingPrice').val(),
                    SellingPrice: $('#SellingPrice').val()
               }
                    $.ajax({
                        type: 'PUT',
                        url: baseUrl + 'Values/AddUpdateData/',
                        data: data,
                        success: function (res) {
                            console.log(res);
                            toastr["success"](res.Message);
                            /*GetProductList();*/
                            window.location.reload();
                        },
                        error: function (res) {
                            console.log(res);
                            toastr["error"](res.Message);
                        }
                    });
             }
        });

    });


    $("#modalShowing").on('click', function (e) {
        $("#Id").val('');
        $("#ProductName").val('');
        $("#BuyingPrice").val('');
        $("#SellingPrice").val('');
        $('#title').html('Add Product');
        $('#addmodal').modal('show');
    });

    function GetProductList() {
        let rowCount = 0;
        let htmlData = '';
        $.ajax({
            type: "GET",
            url: baseUrl + 'Values/GetProductList/',
            contentType: "application/json; charset=utf-8",
            success: function (res) {
                console.log(res.result.length);
                if (res.result.length == 0) {
                    $("#lst").html('<th>\
                             <th colspan="4" class="text-center text-danger">' + 'Record not found!' + '</th>\
                            </th>');
                }
                else {
                    for (i = 0; i < res.result.length; i++) {
                        rowCount = rowCount + 1;
                        htmlData +=
                            '<tr id ="' + res.result[i]['Id'] + '">\
                                    <td>' + rowCount + '</td>\
                                    <td>' + res.result[i]['ProductName'] + '</td>\
                                    <td>' + res.result[i]['BuyingPrice'] + '</td>\
                                    <td>' + res.result[i]['SellingPrice'] + '</td>\
                                    <th style="text-align:center !important;">\ <button type="button" id="' + res.result[i]['Id'] + '" name="btnEdit" value="' + res.result[i]['Id'] + '" class="btn btn-primary btnEdit" style="width:70px;">Edit</button> \</th>\
                        <th style="text-align:center !important;">\ <button type="button" id="' + res.result[i]['Id'] + '" name="btnDelete" value="' + res.result[i]['Id'] + '" class="btn btn-danger btnDelete" style="width:70px;">Delete</button> \</th>\
                               </tr>';
                    };
                    $("#lst").html(htmlData);
                }
            },
            error: function (res) {
                console.log(res);
                toastr["error"](res.Message);
            }
        });
    };

    $('body').on('click', '.btnEdit', function (e) {
        var id = e.target.value;
        $.ajax({
            type: "GET",
            url: baseUrl + 'Values/GetEditDataById/' + id,
            contentType: "application/json; charset=utf-8",
            success: function (res) {
                console.log(res);
                $('#Id').val(res.result[0].Id);
                $('#ProductName').val(res.result[0].ProductName);
                $('#BuyingPrice').val(res.result[0].BuyingPrice);
                $('#SellingPrice').val(res.result[0].SellingPrice);
                $('#title').html('Update Product');
                $('#addmodal').modal('show');
            },
            error: function (res) {
                console.log(res);
                toastr["error"](res.Message);
            }
        });
    });

    $('body').on('click', '.btnDelete', function (e) {
        var id = e.target.value;
        var _confirm = confirm("Are you sure you want to delete this ?");
        if (_confirm == true) {
            $.ajax({
                type: "Delete",
                url: baseUrl + 'Values/DeletItem/' + id,
                contentType: "application/json; charset=utf-8",
                success: function (res) {
                    toastr["success"](res.Message);
                    GetProductList();
                    console.log(res);
                },
                error: function (res) {
                    console.log(res);
                    toastr["error"](res.Message);
                }
            });
        }
        _confirm = false;
    });


</script>